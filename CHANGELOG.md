- Added compatibility with Shared Resources.
- Cleaned up some of the code, this shouldn't break things... in theory.